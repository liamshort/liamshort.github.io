<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Terraform and Git Repositories | liamshort</title><meta name=keywords content="terraform,github"><meta name=description content="TL;DR Manage Git Repositories using the following Terraform module for GitHub.
Overview Just had a great idea for a new project and want to get coding ASAP? The first task is often setting up a Git repository to host the code. If you&rsquo;re like me and love to tinkerer, you can quickly accumulate repositories which makes things feel cluttered! Why not manage your repositories via Terraform?
Terraform, the open source Infrastructure as Code (IaC) tool developed by Hashicorp."><meta name=author content><link rel=canonical href=http://liamshort.dev/posts/terraform-github-repositories/><link crossorigin=anonymous href=/assets/css/stylesheet.3ae1eb45703d185443212554d2690277e6ae74e857262f2bbf2ada1213bed721.css integrity="sha256-OuHrRXA9GFRDISVU0mkCd+audOhXJi8rvyraEhO+1yE=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://liamshort.dev/favicons/cloud.svg><link rel=icon type=image/png sizes=16x16 href=http://liamshort.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://liamshort.dev/favicon-32x32.png><link rel=apple-touch-icon href=http://liamshort.dev/apple-touch-icon.png><link rel=mask-icon href=http://liamshort.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Terraform and Git Repositories"><meta property="og:description" content="TL;DR Manage Git Repositories using the following Terraform module for GitHub.
Overview Just had a great idea for a new project and want to get coding ASAP? The first task is often setting up a Git repository to host the code. If you&rsquo;re like me and love to tinkerer, you can quickly accumulate repositories which makes things feel cluttered! Why not manage your repositories via Terraform?
Terraform, the open source Infrastructure as Code (IaC) tool developed by Hashicorp."><meta property="og:type" content="article"><meta property="og:url" content="http://liamshort.dev/posts/terraform-github-repositories/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-05T13:09:27+01:00"><meta property="article:modified_time" content="2022-02-05T13:09:27+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Terraform and Git Repositories"><meta name=twitter:description content="TL;DR Manage Git Repositories using the following Terraform module for GitHub.
Overview Just had a great idea for a new project and want to get coding ASAP? The first task is often setting up a Git repository to host the code. If you&rsquo;re like me and love to tinkerer, you can quickly accumulate repositories which makes things feel cluttered! Why not manage your repositories via Terraform?
Terraform, the open source Infrastructure as Code (IaC) tool developed by Hashicorp."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"http://liamshort.dev/posts/"},{"@type":"ListItem","position":3,"name":"Terraform and Git Repositories","item":"http://liamshort.dev/posts/terraform-github-repositories/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Terraform and Git Repositories","name":"Terraform and Git Repositories","description":"TL;DR Manage Git Repositories using the following Terraform module for GitHub.\nOverview Just had a great idea for a new project and want to get coding ASAP? The first task is often setting up a Git repository to host the code. If you\u0026rsquo;re like me and love to tinkerer, you can quickly accumulate repositories which makes things feel cluttered! Why not manage your repositories via Terraform?\nTerraform, the open source Infrastructure as Code (IaC) tool developed by Hashicorp.","keywords":["terraform","github"],"articleBody":"TL;DR Manage Git Repositories using the following Terraform module for GitHub.\nOverview Just had a great idea for a new project and want to get coding ASAP? The first task is often setting up a Git repository to host the code. If you’re like me and love to tinkerer, you can quickly accumulate repositories which makes things feel cluttered! Why not manage your repositories via Terraform?\nTerraform, the open source Infrastructure as Code (IaC) tool developed by Hashicorp. Terraform uses Hashicorp Configuration Language (HCL) to define and deploy all manner of things and allows users to create and consume Providers, which are plugins for services like AWS, GCP, Azure, DigitalOcean. You can view all the Official, Verified and community Providers here. Terraform also allows users to create and share their own Modules, bundles of Terraform code designed to perform a specific task. For example, if we needed a CICD pipeline for AWS, we could use this module created by CloudPosse. For more information on Terraform modules, look here.\nMy first real exposure to Terraform was in 2020, when preparing for a new client engagement I got my Hashicorp Terraform Associate Certification. Before this time I had been working mostly with AWS CloudFormation, which in comparison now feels clunky. To name a few of the features which makes Terraform attractive to me:\nCloud agnostic, meaning it can be used across all the major CSPs with no vendor lock in HCL is logical, it just makes sense Modules are insanely useful State management is controlled by the user (glad I haven’t touched a CloudFormation Stack in years) GitHub is the most popular Git provider, synonymous with Git itself. We can use the GitHub Provider for Terraform to create and manage various things like Repositories, Actions and User / Organization permissions.\nThe Module I put together a simple Terraform Module which can be used to manage Git repositores for GitHub (the same logic can be applied for other Git management tools such as CodeCommit or Gitea):\nGitHub Usage The modules all follow the same configuration, containing a config.yml file which contains the definitions of our repositories in HCL. Based on the contents of this file we can create, update or delete repositires. Below is an example of a GitHub repository definition from the config.yml:\nmy-super-cool-repo: description: Code glorious code visibility: public topics: [ \"stuff\" ] has_wiki: true has_projects: true has_issues: true vulnerability_alerts: true Importing We can import existing repositories that were created manually, to do this add a definition to the config.yml which matches the configuration of the existing repository. The repository can then be imported to the Terraform state by running the terraform import command, as shown below:\nterraform import 'module.github.github_repository.this[\"my-super-cool-repo\"]' my-super-cool-repo Voila! Your repo can now be managed using Terraform. After the import run a terraform plan to confirm what differences (if any) Terraform has detected between your code and the actual repository configuration. Terraform will try to resolve these if we run a subsequent terraform apply.\n","wordCount":"496","inLanguage":"en","datePublished":"2022-02-05T13:09:27+01:00","dateModified":"2022-02-05T13:09:27+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://liamshort.dev/posts/terraform-github-repositories/"},"publisher":{"@type":"Organization","name":"liamshort","logo":{"@type":"ImageObject","url":"https://liamshort.dev/favicons/cloud.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://liamshort.dev accesskey=h title="liamshort (Alt + H)">liamshort</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://liamshort.dev/cv/ title=cv><span>cv</span></a></li><li><a href=http://liamshort.dev/archives/ title=archives><span>archives</span></a></li><li><a href=http://liamshort.dev/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=http://liamshort.dev/tags/ title=tags><span>tags</span></a></li><li><a href=http://liamshort.dev/podcasts/ title=podcasts><span>podcasts</span></a></li><li><a href=http://liamshort.dev/profiles/ title=profiles><span>profiles</span></a></li><li><a href=http://liamshort.dev/wordle/ title=wordle><span>wordle</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Terraform and Git Repositories</h1><div class=post-meta><span title='2022-02-05 13:09:27 +0100 +0100'>February 5, 2022</span></div></header><div class=post-content><h1 id=tldr>TL;DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h1><p>Manage Git Repositories using the following Terraform module for <a href=https://github.com/liamshort/tf-mod-github-repos>GitHub</a>.</p><h1 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h1><p>Just had a great idea for a new project and want to get coding ASAP? The first task is often setting up a Git repository to host the code. If you&rsquo;re like me and love to tinkerer, you can quickly accumulate repositories which makes things feel cluttered! Why not manage your repositories via Terraform?</p><p><a href=https://www.terraform.io/intro>Terraform</a>, the open source Infrastructure as Code (IaC) tool developed by Hashicorp. Terraform uses Hashicorp Configuration Language (HCL) to define and deploy all manner of things and allows users to create and consume Providers, which are plugins for services like AWS, GCP, Azure, DigitalOcean. You can view all the Official, Verified and community Providers <a href=https://registry.terraform.io/browse/providers>here</a>. Terraform also allows users to create and share their own Modules, bundles of Terraform code designed to perform a specific task. For example, if we needed a CICD pipeline for AWS, we could use <a href=https://registry.terraform.io/modules/cloudposse/cicd/aws/latest>this</a> module created by CloudPosse. For more information on Terraform modules, look <a href=https://www.terraform.io/language/modules>here</a>.</p><p>My first real exposure to Terraform was in 2020, when preparing for a new client engagement I got my Hashicorp Terraform Associate Certification. Before this time I had been working mostly with AWS CloudFormation, which in comparison now feels clunky. To name a few of the features which makes Terraform attractive to me:</p><ul><li>Cloud agnostic, meaning it can be used across all the major CSPs with no vendor lock in</li><li>HCL is logical, it just makes sense</li><li>Modules are insanely useful</li><li>State management is controlled by the user (glad I haven&rsquo;t touched a CloudFormation Stack in years)</li></ul><p><a href=https://github.com>GitHub</a> is the most popular Git provider, synonymous with Git itself. We can use the <a href=https://registry.terraform.io/providers/integrations/github/latest/docs>GitHub Provider</a> for Terraform to create and manage various things like Repositories, Actions and User / Organization permissions.</p><h1 id=the-module>The Module<a hidden class=anchor aria-hidden=true href=#the-module>#</a></h1><p>I put together a simple Terraform Module which can be used to manage Git repositores for GitHub (the same logic can be applied for other Git management tools such as CodeCommit or Gitea):</p><ul><li><a href=https://github.com/liamshort/tf-mod-github-repos>GitHub</a></li></ul><h2 id=usage>Usage<a hidden class=anchor aria-hidden=true href=#usage>#</a></h2><p>The modules all follow the same configuration, containing a <code>config.yml</code> file which contains the definitions of our repositories in HCL. Based on the contents of this file we can create, update or delete repositires. Below is an example of a GitHub repository definition from the <code>config.yml</code>:</p><pre tabindex=0><code>my-super-cool-repo:
description: Code glorious code
visibility: public
topics: [
    &#34;stuff&#34;
]
has_wiki: true
has_projects: true
has_issues: true
vulnerability_alerts: true
</code></pre><h2 id=importing>Importing<a hidden class=anchor aria-hidden=true href=#importing>#</a></h2><p>We can import existing repositories that were created manually, to do this add a definition to the <code>config.yml</code> which matches the configuration of the existing repository. The repository can then be imported to the Terraform state by running the <code>terraform import</code> command, as shown below:</p><pre tabindex=0><code>terraform import &#39;module.github.github_repository.this[&#34;my-super-cool-repo&#34;]&#39; my-super-cool-repo
</code></pre><p>Voila! Your repo can now be managed using Terraform. After the import run a <code>terraform plan</code> to confirm what differences (if any) Terraform has detected between your code and the actual repository configuration. Terraform will try to resolve these if we run a subsequent <code>terraform apply</code>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://liamshort.dev/tags/terraform/>terraform</a></li><li><a href=http://liamshort.dev/tags/github/>github</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Terraform and Git Repositories on twitter" href="https://twitter.com/intent/tweet/?text=Terraform%20and%20Git%20Repositories&url=http%3a%2f%2fliamshort.dev%2fposts%2fterraform-github-repositories%2f&hashtags=terraform%2cgithub"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Terraform and Git Repositories on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fliamshort.dev%2fposts%2fterraform-github-repositories%2f&title=Terraform%20and%20Git%20Repositories&summary=Terraform%20and%20Git%20Repositories&source=http%3a%2f%2fliamshort.dev%2fposts%2fterraform-github-repositories%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Terraform and Git Repositories on telegram" href="https://telegram.me/share/url?text=Terraform%20and%20Git%20Repositories&url=http%3a%2f%2fliamshort.dev%2fposts%2fterraform-github-repositories%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://https-liamshort-dev.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><footer class=footer><span>last build: 7 December 2022</span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>